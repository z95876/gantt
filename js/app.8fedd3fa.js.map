{"version":3,"file":"js/app.8fedd3fa.js","mappings":"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EACA,EACA,EACA,EACA,EACA,EACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,IAEF,aAAgB,EAChB,WAAc,GAEhB,CACE,KAAQ,cACR,UAAa,CACX,EACA,EACA,EACA,EACA,GAEF,aAAgB,EAChB,WAAc,GAEhB,CACE,KAAQ,cACR,UAAa,CACX,EACA,EACA,EACA,EACA,GAEF,aAAgB,EAChB,WAAc,GAEhB,CACE,KAAQ,cACR,UAAa,CACX,EACA,EACA,EACA,EACA,GAEF,aAAgB,EAChB,WAAc,GAEhB,CACE,KAAQ,aACR,UAAa,CACX,EACA,EACA,EACA,EACA,EACA,IAEF,aAAgB,EAChB,WAAc,GAEhB,CACE,KAAQ,aACR,UAAa,CACX,EACA,EACA,EACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,IAEF,aAAgB,EAChB,WAAc,GAEhB,CACE,KAAQ,UACR,UAAa,CACX,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,IAEF,aAAgB,EAChB,WAAc,GAEhB,CACE,KAAQ,aACR,UAAa,CACX,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,IAEF,aAAgB,EAChB,WAAc,GAEhB,CACE,KAAQ,YACR,UAAa,CACX,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,IAEF,aAAgB,EAChB,WAAc,GAEhB,CACE,KAAQ,YACR,UAAa,CACX,IAEF,aAAgB,EAChB,WAAc,GAEhB,CACE,KAAQ,YACR,UAAa,CACX,GACA,GACA,GACA,GACA,GACA,GACA,GACA,IAEF,aAAgB,EAChB,WAAc,GAEhB,CACE,KAAQ,YACR,UAAa,CACX,EACA,EACA,EACA,GAEF,aAAgB,EAChB,WAAc,GAEhB,CACE,KAAQ,cACR,UAAa,CACX,EACA,EACA,EACA,GAEF,aAAgB,EAChB,WAAc,GAEhB,CACE,KAAQ,YACR,UAAa,CACX,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,IAEF,aAAgB,EAChB,WAAc,KAIZC,GAAgB,SAAI,GACpBC,GAAsB,SAAI,GAChC,IAAIC,GAAa,QAAI,CACnB7I,KAAM,GACN8I,UAAW,KAETC,GAAgB,QAAI,MACxB,MAAMb,GAAa,QAAI,IACjBc,GAAW,QAAI,MACfzB,GAAgB,QAAI,IACpBG,GAAc,QAAI,IAElBD,EAAe,CACnB,CACE,MAAS,SACT,MAAS,GAEX,CACE,MAAS,SACT,MAAS,GAEX,CACE,MAAS,eACT,MAAS,GAEX,CACE,MAAS,eACT,MAAS,GAEX,CACE,MAAS,eACT,MAAS,GAEX,CACE,MAAS,UAC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","sources":["webpack://ghjhxm/./src/App.vue","webpack://ghjhxm/./src/App.vue?7ccd","webpack://ghjhxm/./src/views/GanttChart.vue","webpack://ghjhxm/./src/views/GanttChart.vue?be69","webpack://ghjhxm/./src/views/CapabilityTable.vue","webpack://ghjhxm/./src/views/CapabilityTable.vue?d556","webpack://ghjhxm/./src/views/DecisionTree.vue","webpack://ghjhxm/./src/views/DecisionTree.vue?e64a","webpack://ghjhxm/./src/router/index.js","webpack://ghjhxm/./src/main.js","webpack://ghjhxm/webpack/bootstrap","webpack://ghjhxm/webpack/runtime/chunk loaded","webpack://ghjhxm/webpack/runtime/define property getters","webpack://ghjhxm/webpack/runtime/global","webpack://ghjhxm/webpack/runtime/hasOwnProperty shorthand","webpack://ghjhxm/webpack/runtime/make namespace object","webpack://ghjhxm/webpack/runtime/jsonp chunk loading","webpack://ghjhxm/webpack/startup"],"sourcesContent":["<template>\r\n  <div id=\"app\">\r\n    <el-menu\r\n        mode=\"horizontal\"\r\n        :default-active=\"activeTab\"\r\n        background-color=\"#545c64\"\r\n        text-color=\"#fff\"\r\n        active-text-color=\"#ffd04b\"\r\n        router\r\n        class=\"fixed-tab\"\r\n    >\r\n      <el-menu-item index=\"/gantt\">项目要素管理与可视化</el-menu-item>\r\n      <el-menu-item index=\"/capability\">协同调控</el-menu-item>\r\n      <el-menu-item index=\"/decision\">关联分析</el-menu-item>\r\n    </el-menu>\r\n\r\n    <div class=\"view-container\">\r\n      <router-view />\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { useRoute } from 'vue-router'\r\n\r\nexport default {\r\n  setup() {\r\n    const route = useRoute()\r\n    return {\r\n      activeTab: route.path\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.fixed-tab {\r\n  position: fixed;\r\n  top: 0;\r\n  width: 100%;\r\n  z-index: 999;\r\n}\r\n\r\n.view-container {\r\n  margin-top: 60px;\r\n  padding: 20px;\r\n}\r\n</style>\r\n","import { render } from \"./App.vue?vue&type=template&id=4435c627&scoped=true\"\nimport script from \"./App.vue?vue&type=script&lang=js\"\nexport * from \"./App.vue?vue&type=script&lang=js\"\n\nimport \"./App.vue?vue&type=style&index=0&id=4435c627&scoped=true&lang=css\"\n\nimport exportComponent from \"../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-4435c627\"]])\n\nexport default __exports__","<template>\r\n  <div style=\"display: flex; align-items: baseline; justify-content: space-between; margin-bottom: 20px;\">\r\n    <div>\r\n      <h2 class=\"text-2xl font-bold mb-4\" style=\"margin-top: 0\">基本作战单位子项目群</h2>\r\n      <div class=\"controls mb-2\">\r\n        <el-button type=\"primary\" @click=\"currentView = 'gantt'\">甘特图</el-button>\r\n        <el-button type=\"primary\" @click=\"currentView = 'topo'; resizeChart()\">拓扑图</el-button>\r\n      </div>\r\n    </div>\r\n    <div style=\"font-size: 12px; color: #666; line-height: 1.5; margin-left: 16px; margin-top: 0\">\r\n      <div>依赖规则：</div>\r\n      <div>1.<strong>条令子项目</strong>、<strong>基础设施子项目</strong>和<strong>组织编制子项目</strong>应在<strong>装备子项目</strong>和<strong>训练子项目</strong>开始前开始。</div>\r\n      <div>2.<strong>基础设施子项目</strong>应在<strong>装备子项目</strong>和<strong>训练子项目</strong>结束前结束，<strong>训练子项目</strong>应在<strong>装备子项目</strong>结束前结束。</div>\r\n      <div>3.父项目时间范围应覆盖全部的子项目。</div>\r\n    </div>\r\n  </div>\r\n  <div v-show=\"currentView === 'gantt'\" ref=\"ganttContainer\" class=\"gantt-container\" ></div>\r\n  <div v-show=\"currentView === 'topo'\" ref=\"chart\" class=\"chart-container\"></div>\r\n</template>\r\n\r\n<script setup>\r\nimport {ref, onMounted, onBeforeUnmount, nextTick} from 'vue'\r\nimport gantt from 'dhtmlx-gantt'\r\nimport 'dhtmlx-gantt/codebase/dhtmlxgantt.css'\r\nimport { ElButton, ElMessageBox } from 'element-plus'\r\nimport * as echarts from 'echarts'\r\n\r\nconst treeData = {\r\n  \"name\": \"基本作战单位子项目群\",\r\n  \"children\": [\r\n    {\r\n      \"name\": \"条令子项目\",\r\n      \"children\": [\r\n        {\r\n          \"name\": \"坦克分队作战条令\"\r\n        },\r\n        {\r\n          \"name\": \"装甲步兵分队作战条令\"\r\n        },\r\n        {\r\n          \"name\": \"侦察分队作战条令\"\r\n        },\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"装备子项目\",\r\n      \"children\": [\r\n        {\r\n          \"name\": \"坦克装备\"\r\n        },\r\n        {\r\n          \"name\": \"步战车装备\"\r\n        },\r\n        {\r\n          \"name\": \"122榴弹炮装备\"\r\n        },\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"训练子项目\",\r\n      \"children\": [\r\n        {\r\n          \"name\": \"合成分队训练场\"\r\n        },\r\n        {\r\n          \"name\": \"兵种分队训练场\"\r\n        },\r\n        {\r\n          \"name\": \"模拟训练\"\r\n        },\r\n        {\r\n          \"name\": \"训练与考核大纲\"\r\n        },\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"基础设施子项目\",\r\n      \"children\": [\r\n        {\r\n          \"name\": \"通信基础设施\"\r\n        },\r\n        {\r\n          \"name\": \"维修基础设施\"\r\n        },\r\n        {\r\n          \"name\": \"营房基础设施\"\r\n        },\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"组织编制子项目\",\r\n      \"children\": [\r\n        {\r\n          \"name\": \"坦克分队编制\"\r\n        },\r\n        {\r\n          \"name\": \"装甲步兵分队编制\"\r\n        },\r\n        {\r\n          \"name\": \"侦察分队编制\"\r\n        },\r\n      ]\r\n    },\r\n  ]\r\n}\r\n\r\nconst currentView = ref('gantt')\r\nconst ganttContainer = ref(null)\r\nconst chart = ref(null)\r\nlet myChart = null\r\n\r\nconst tasksData = {\r\n  data: [\r\n    { id: 1,  text: '条令子项目',         start_date: '2025-01-01', duration: 310, parent: 0, unit: '总部' },\r\n    { id: 2,  text: '坦克分队条令',       start_date: '2025-01-01', duration: 270,  parent: 1, unit: '装甲部' },\r\n    { id: 3,  text: '装甲步兵条令',       start_date: '2025-02-01', duration: 280,  parent: 1, unit: '步兵部' },\r\n    { id: 4,  text: '侦察分队条令',       start_date: '2025-03-01', duration: 260,  parent: 1, unit: '侦察部' },\r\n\r\n    { id: 5,  text: '装备子项目',         start_date: '2025-07-01', duration: 1600, parent: 0, unit: '后勤部' },\r\n    { id: 6,  text: '坦克装备子项目',     start_date: '2025-08-01', duration: 1509,  parent: 5, unit: '装甲部' },\r\n    { id: 7,  text: '步战车装备子项目',   start_date: '2025-07-01', duration: 1589,  parent: 5, unit: '机械部' },\r\n    { id: 8,  text: '122榴弹炮装备',      start_date: '2025-09-01', duration: 1538,  parent: 5, unit: '炮兵部' },\r\n\r\n    { id: 9,  text: '训练子项目',         start_date: '2026-01-01', duration: 1234, parent: 0, unit: '训练部' },\r\n    { id: 10, text: '合成分队训练场',     start_date: '2026-01-01', duration: 1144,  parent: 9, unit: '训练部' },\r\n    { id: 11, text: '兵种分队训练场',     start_date: '2026-01-01', duration: 1144,  parent: 9, unit: '训练部' },\r\n    { id: 12, text: '模拟训练子项目',     start_date: '2026-03-01', duration: 1170,  parent: 9, unit: '训练部' },\r\n    { id: 13, text: '训练与考核大纲',     start_date: '2026-01-01', duration: 1234,  parent: 9, unit: '训练部' },\r\n\r\n    { id: 14, text: '基础设施子项目',     start_date: '2025-01-01', duration: 330, parent: 0, unit: '工程部' },\r\n    { id: 15, text: '通信基础设施',       start_date: '2025-01-20', duration: 280,  parent: 14, unit: '通信部' },\r\n    { id: 16, text: '维修基础设施',       start_date: '2025-01-01', duration: 330,  parent: 14, unit: '工程部' },\r\n    { id: 17, text: '营房基础设施',       start_date: '2025-01-20', duration: 180,  parent: 14, unit: '工兵部' },\r\n\r\n    { id: 18, text: '组织编制子项目',     start_date: '2025-01-01', duration: 300, parent: 0, unit: '人事部' },\r\n    { id: 19, text: '坦克分队编制',       start_date: '2025-01-01', duration: 290,  parent: 18, unit: '人事部' },\r\n    { id: 20, text: '装甲步兵编制',       start_date: '2025-01-01', duration: 300,  parent: 18, unit: '人事部' },\r\n    { id: 21, text: '侦察分队编制',       start_date: '2025-01-10', duration: 290,  parent: 18, unit: '人事部' }\r\n  ],\r\n  links: [\r\n    { id: 1,  source: 1,  target: 5,   type: '1' },\r\n    { id: 2,  source: 1,  target: 9,   type: '1' },\r\n\r\n    { id: 4,  source: 14,  target: 5,   type: '1' },\r\n    { id: 5,  source: 14, target: 9,   type: '1' },\r\n\r\n    { id: 6,  source: 18,  target: 5,   type: '1' },\r\n    { id: 7,  source: 18,  target: 9,   type: '1' },\r\n\r\n    { id: 8,  source: 9, target: 5,   type: '2' },\r\n\r\n    { id: 9,  source: 14,  target: 5,   type: '2' },\r\n\r\n    { id: 10, source: 14,  target: 9,   type: '2' },\r\n  ]\r\n}\r\n\r\nfunction setYearView() {\r\n  gantt.config.scale_unit = 'year'\r\n  gantt.config.date_scale = '%Y'\r\n  gantt.config.subscales = [{ unit: 'month', step: 1, date: '%m' }]\r\n  gantt.render()\r\n}\r\nfunction setMonthView() {\r\n  gantt.config.scale_unit = 'month'\r\n  gantt.config.date_scale = '%Y-%m'\r\n  gantt.config.subscales = [{ unit: 'day', step: 1, date: '%d' }]\r\n  gantt.render()\r\n}\r\nfunction setAllView() {\r\n  gantt.config.scale_unit = 'year'\r\n  gantt.config.date_scale = '%Y'\r\n  gantt.config.subscales = [{ unit: 'year', step: 1, date: '%d' }]\r\n  gantt.render()\r\n}\r\n\r\nfunction resizeChart() {\r\n  nextTick(() => {\r\n    if (myChart) {\r\n      myChart.resize();\r\n    }\r\n  });\r\n}\r\n\r\nlet afterDragEventId;\r\nonMounted(() => {\r\n  gantt.config.xml_date = '%Y-%m-%d'\r\n  gantt.config.cascade_delete = false\r\n  gantt.config.show_tasks_outside_timescale = true\r\n  gantt.config.drag_progress = false\r\n  gantt.config.columns = [\r\n    { name: 'text', label: '项目名称', width: 200, tree: true },\r\n    { name: 'unit', label: '交付单位', width: 120, align: 'center' },\r\n    { name: 'add',  label: '',         width: 44 }\r\n  ];\r\n  gantt.config.lightbox.sections = [\r\n    { name: \"description\", height: 38, map_to: \"text\", type: \"textarea\", focus: true, label: \"任务名称\" },\r\n    { name: \"time\", type: \"duration\", map_to: \"auto\", label: \"时间安排\" }\r\n  ];\r\n  gantt.locale.date = {\r\n    month_full: [\"一月\", \"二月\", \"三月\", \"四月\", \"五月\", \"六月\",\r\n      \"七月\", \"八月\", \"九月\", \"十月\", \"十一月\", \"十二月\"],\r\n    month_short: [\"1月\", \"2月\", \"3月\", \"4月\", \"5月\", \"6月\",\r\n      \"7月\", \"8月\", \"9月\", \"10月\", \"11月\", \"12月\"],\r\n    day_full: [\"星期日\", \"星期一\", \"星期二\", \"星期三\", \"星期四\", \"星期五\", \"星期六\"],\r\n    day_short: [\"日\", \"一\", \"二\", \"三\", \"四\", \"五\", \"六\"],\r\n    hours: \"时间\",\r\n    minutes: \"分钟\",\r\n    seconds: \"秒\",\r\n    date_format: \"%Y-%m-%d\",\r\n    time_format: \"%H:%i\",\r\n    month_day: \"%M %d\"\r\n  };\r\n\r\n  Object.assign(gantt.locale.labels, {\r\n    new_task: \"新建任务\",\r\n    icon_save: \"保存\",\r\n    icon_cancel: \"取消\",\r\n    icon_details: \"详情\",\r\n    icon_edit: \"编辑\",\r\n    icon_delete: \"删除\",\r\n    confirm_closing: \"\",  // 弹出框关闭确认提示（空字符串表示无提示）\r\n    confirm_deleting: \"您确定要删除该任务吗？\",\r\n    section_description: \"任务名称\",\r\n    section_time: \"时间安排\",\r\n    save_button: \"保存\",\r\n    cancel_button: \"取消\",\r\n    delete_button: \"删除\",\r\n  });\r\n\r\n\r\n\r\n\r\n  setAllView()\r\n  gantt.config.start_date = new Date(2024, 11, 1)\r\n  gantt.config.end_date   = new Date(2029, 11, 31)\r\n\r\n  // 样式模板：根项目分色\r\n  gantt.templates.task_class = (s, e, task) => {\r\n    const classes = []\r\n    let root = task.id\r\n    let pid = task.parent\r\n    while (pid && pid !== 0) {\r\n      const p = gantt.getTask(pid)\r\n      if (!p) break\r\n      root = pid\r\n      pid = p.parent\r\n    }\r\n    classes.push('project-' + root)\r\n    return classes.join(' ')\r\n  }\r\n\r\n  // 拖拽后检查范围覆盖关系\r\n  afterDragEventId = gantt.attachEvent('onAfterTaskDrag', (id) => {\r\n    const task = gantt.getTask(id)\r\n\r\n    // 子任务检查：是否全部被包含\r\n    const children = gantt.getChildren(id)\r\n    if (children.length > 0) {\r\n      const invalidChild = children.find(cid => {\r\n        const c = gantt.getTask(cid)\r\n        return c.start_date < task.start_date || c.end_date > task.end_date\r\n      })\r\n      if (invalidChild) {\r\n        ElMessageBox.alert(`项目【${task.text}】未完全覆盖子项目的时间范围！`, '提示')\r\n      }\r\n    }\r\n\r\n    // 父任务检查：是否超出父项目\r\n    if (task.parent && task.parent !== 0) {\r\n      const parent = gantt.getTask(task.parent)\r\n      if (task.start_date < parent.start_date || task.end_date > parent.end_date) {\r\n        ElMessageBox.alert(`项目【${task.text}】超出了父项目【${parent.text}】的时间范围！`, '提示')\r\n      }\r\n    }\r\n\r\n    // 你的依赖关系数据\r\n    const links = [\r\n      { id: 1,  source: 1,  target: 5, type: '1' },\r\n      { id: 2,  source: 1,  target: 9, type: '1' },\r\n      { id: 4,  source: 14, target: 5, type: '1' },\r\n      { id: 5,  source: 14, target: 9, type: '1' },\r\n      { id: 6,  source: 18, target: 5, type: '1' },\r\n      { id: 7,  source: 18, target: 9, type: '1' },\r\n      { id: 8,  source: 9,  target: 5, type: '2' },\r\n      { id: 9,  source: 14, target: 5, type: '2' },\r\n      { id: 10, source: 14, target: 9, type: '2' },\r\n    ];\r\n\r\n    // 进行依赖检查\r\n    links.forEach(link => {\r\n      const source = gantt.getTask(link.source);\r\n      const target = gantt.getTask(link.target);\r\n      if (!source || !target) return;\r\n\r\n      if (link.type === '1') {\r\n        if (gantt.date.parseDate(source.start_date) > gantt.date.parseDate(target.start_date)) {\r\n          ElMessageBox.alert(`依赖错误：任务【${source.text}】开始后，【${target.text}】才能开始！`);\r\n        }\r\n      }\r\n      if (link.type === '2') {\r\n        const sourceEnd = gantt.calculateEndDate(source.start_date, source.duration);\r\n        const targetEnd = gantt.calculateEndDate(target.start_date, target.duration);\r\n        if (sourceEnd > targetEnd) {\r\n          ElMessageBox.alert(`依赖错误：任务【${source.text}】结束后，【${target.text}】才能结束！`);\r\n        }\r\n      }\r\n    });\r\n  })\r\n\r\n\r\n  gantt.init(ganttContainer.value)\r\n\r\n  gantt.parse(tasksData)\r\n  setTimeout(() => {\r\n    gantt.eachTask(t => { if (gantt.hasChild(t.id)) gantt.open(t.id) })\r\n  }, 0)\r\n\r\n\r\n  myChart = echarts.init(chart.value)\r\n  const option = {\r\n    tooltip: {\r\n      trigger: 'item',\r\n      triggerOn: 'mousemove'\r\n    },\r\n    series: [\r\n      {\r\n        type: 'tree',\r\n        roam: true, // 允许拖动画布\r\n        data: [treeData],\r\n        top: '10%',\r\n        left: '5%',\r\n        bottom: '20%',\r\n        right: '5%',\r\n        symbol: 'emptyCircle',\r\n        orient: 'vertical',\r\n        expandAndCollapse: true,\r\n        initialTreeDepth: 3,\r\n        label: {\r\n          position: 'left',\r\n          verticalAlign: 'middle',\r\n          align: 'right',\r\n          fontSize: 14,\r\n          padding: [0, 0, 15, 0],\r\n        },\r\n        leaves: {\r\n          label: {\r\n            position: 'right',\r\n            verticalAlign: 'middle',\r\n            align: 'left',\r\n            formatter: function(params) {\r\n              return params.name.split('').join('\\n')\r\n            },\r\n            padding: [0, 0, 10, 0],     // 增加底部空间\r\n            overflow: 'break',           // 防止裁剪\r\n          }\r\n        },\r\n        grid: {\r\n          top: 50,\r\n          bottom: 100, // 保证底部留足空间\r\n          left: 50,\r\n          right: 50\r\n        },\r\n      }\r\n    ]\r\n  }\r\n  myChart.setOption(option)\r\n  myChart && myChart.resize()\r\n  window.addEventListener('resize', resizeChart)\r\n})\r\n\r\nonBeforeUnmount(() => {\r\n  if (afterDragEventId) {\r\n    gantt.detachEvent(afterDragEventId)\r\n  }\r\n  gantt.clearAll()\r\n  window.removeEventListener('resize', resizeChart)\r\n  myChart && myChart.dispose()\r\n})\r\n</script>\r\n\r\n<style>\r\n.gantt-container { width:100%;height:700px;border:1px solid #ccc;overflow:auto }\r\n.controls { display:flex;gap:8px;margin-bottom:12px }\r\n/* 根项目着色 */\r\n.gantt_task_line.project-1 .gantt_task_content  { background:#e74c3c!important; border-color:#e74c3c!important; }\r\n.gantt_task_line.project-5 .gantt_task_content  { background:#3498db!important; border-color:#3498db!important; }\r\n.gantt_task_line.project-9 .gantt_task_content  { background:#2ecc71!important; border-color:#2ecc71!important; }\r\n.gantt_task_line.project-14 .gantt_task_content { background:#f1c40f!important; border-color:#f1c40f!important; }\r\n.gantt_task_line.project-18 .gantt_task_content { background:#9b59b6!important; border-color:#9b59b6!important; }\r\n/* 超出标红 */\r\n.gantt_task_line.out-of-range .gantt_task_content { background:#c0392b!important; border-color:#c0392b!important; }\r\n\r\n\r\n/* 修改后（所有项目通用） */\r\n.gantt_task_line .gantt_task_content {\r\n  border-radius: 5px !important; /* 强制保留圆角 */\r\n}\r\n/* 在样式中添加 */\r\n.gantt_task_line.progress-overdue {\r\n  background: repeating-linear-gradient(\r\n      45deg,\r\n      transparent,\r\n      transparent 5px,\r\n      rgba(255,0,0,0.1) 5px,\r\n      rgba(255,0,0,0.1) 10px\r\n  ) !important;\r\n}\r\n\r\n</style>\r\n\r\n<style scoped>\r\n.chart-container {\r\n  width: 100%;\r\n  height:500px;\r\n  overflow: visible;\r\n  background: #fafafa;\r\n  border: 1px solid #e0e0e0;\r\n  border-radius: 4px;\r\n}\r\nh2 {\r\n  margin-bottom: 1rem;\r\n}\r\n</style>\r\n","import script from \"./GanttChart.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./GanttChart.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./GanttChart.vue?vue&type=style&index=0&id=757d4c6b&lang=css\"\nimport \"./GanttChart.vue?vue&type=style&index=1&id=757d4c6b&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-757d4c6b\"]])\n\nexport default __exports__","<template>\r\n  <div>\r\n    <h2>项目能力冗余度与满足度表</h2>\r\n    <div class=\"explanation mb-4 text-sm text-gray-700\" style=\"margin-bottom: 20px;\">\r\n      <p>能力满足度：指某个项目完成的全部能力在总能力中所占比例，反映其对总体能力的贡献程度。计算公式：满足度 = 项目完成能力数 / 能力总数</p>\r\n      <p>能力冗余度：指该项目完成的能力中，有多少比例也被其他项目完成，反映项目能力的重复程度。计算公式：冗余度 = 完成能力中被其他项目同时完成的数量 / 项目完成能力数</p>\r\n\r\n      <el-button type=\"primary\" @click=\"dialogVisible = true\">添加项目</el-button>\r\n    </div>\r\n    <el-table :data=\"projects\" style=\"width: 100%\" border>\r\n      <el-table-column prop=\"name\" label=\"项目名称\" />\r\n      <el-table-column\r\n          prop=\"satisfaction\"\r\n          label=\"满足度\"\r\n          sortable\r\n          :sort-method=\"(a, b) => a.satisfaction - b.satisfaction\"\r\n          :formatter=\"row => (row.satisfaction * 100).toFixed(2) + '%'\"\r\n      />\r\n\r\n      <el-table-column\r\n          prop=\"redundancy\"\r\n          label=\"冗余度\"\r\n          sortable\r\n          :sort-method=\"(a, b) => a.redundancy - b.redundancy\"\r\n          :formatter=\"row => (row.redundancy * 100).toFixed(2) + '%'\"\r\n      />\r\n\r\n\r\n      <el-table-column label=\"操作\">\r\n        <template #default=\"{ row }\">\r\n          <el-button size=\"small\" type=\"danger\" @click=\"prepareDelete(row)\">删除</el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n\r\n    <el-dialog v-model=\"dialogVisible\" title=\"添加项目\" width=\"600px\">\r\n      <el-form :model=\"newProject\" label-width=\"100px\">\r\n        <el-form-item label=\"项目名称\">\r\n          <el-input v-model=\"newProject.name\" placeholder=\"请输入项目名称\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"项目具备能力\">\r\n          <el-checkbox-group v-model=\"newProject.abilities\">\r\n            <el-checkbox\r\n                v-for=\"ability in allAbilities\"\r\n                :key=\"ability.value\"\r\n                :label=\"ability.value\"\r\n            >\r\n              {{ ability.label }}\r\n            </el-checkbox>\r\n          </el-checkbox-group>\r\n        </el-form-item>\r\n\r\n      </el-form>\r\n      <template #footer>\r\n        <el-button @click=\"dialogVisible = false\">取消</el-button>\r\n        <el-button type=\"primary\" @click=\"addProject\">添加</el-button>\r\n      </template>\r\n    </el-dialog>\r\n\r\n    <el-dialog v-model=\"impactDialogVisible\" title=\"删除项目影响评估\" width=\"600px\">\r\n      <p>该项目独有能力如下（删除后将丢失这些能力）：<b v-if=\"lostAbilities.length === 0\">无</b></p>\r\n\r\n        <el-tag\r\n            v-for=\"id in lostAbilities\"\r\n            :key=\"id\"\r\n            type=\"danger\"\r\n            class=\"mr-2 mb-2\"\r\n        >\r\n          {{ allAbilities[id][\"label\"] }}\r\n        </el-tag>\r\n      <p style=\"margin-top: 10px;\">影响程度：<b>{{ impactLevel }}</b></p>\r\n      <div style=\"overflow-y: auto;\">\r\n        <p>如果删除项目 <strong>{{ pendingDelete?.name }}</strong> 后，其他项目的冗余度变化如下：</p>\r\n        <el-table :data=\"impactData\" size=\"small\" style=\"width: 100%; height: 350px;\">\r\n          <el-table-column prop=\"name\" label=\"项目名称\" />\r\n          <el-table-column\r\n              prop=\"oldRedundancy\"\r\n              label=\"原冗余度\"\r\n              :formatter=\"row => (row.oldRedundancy * 100).toFixed(2) + '%'\"\r\n          />\r\n          <el-table-column\r\n              prop=\"newRedundancy\"\r\n              label=\"新冗余度\"\r\n              :formatter=\"row => (row.newRedundancy * 100).toFixed(2) + '%'\"\r\n          />\r\n        </el-table>\r\n      </div>\r\n      <template #footer>\r\n        <el-button @click=\"impactDialogVisible = false\">取消</el-button>\r\n        <el-button type=\"danger\" @click=\"confirmDelete\">确认删除</el-button>\r\n        <el-button type=\"success\" @click=\"exportReport\">导出报告</el-button>\r\n      </template>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<style scoped>\r\ntable {\r\n  border-collapse: collapse;\r\n  width: 80%;\r\n  margin: 20px auto;\r\n}\r\nth, td {\r\n  border: 1px solid #ccc;\r\n  padding: 8px;\r\n  text-align: center;\r\n}\r\nth {\r\n  background-color: #eee;\r\n}\r\n</style>\r\n<script setup>\r\nimport { ref } from 'vue'\r\nimport { ElMessage } from 'element-plus'\r\nimport {\r\n  Document,\r\n  Packer,\r\n  Paragraph,\r\n  Table,\r\n  TableRow,\r\n  TableCell,\r\n  TextRun,\r\n} from \"docx\"\r\nimport { saveAs } from \"file-saver\"\r\n\r\nasync function exportReport() {\r\n\r\n  const doc = new Document({\r\n    creator: \"系统自动生成\",       // ← 必须提供\r\n    title: \"删除影响评估报告\",       // ← 推荐提供\r\n    description: \"基于项目能力冗余度与满足度的删除影响分析\",\r\n    styles: {\r\n      paragraphStyles: [\r\n        {\r\n          id: \"Normal\",\r\n          name: \"Normal\",\r\n          run: {\r\n            font: \"Arial\",\r\n            size: 24,\r\n          },\r\n        },\r\n      ],\r\n    },\r\n    sections: [\r\n      {\r\n        properties: {},\r\n        children: [\r\n          new Paragraph({\r\n            text: \"删除影响评估报告\",\r\n            heading: \"Heading1\",\r\n          }),\r\n          // 丢失能力\r\n          new Paragraph({ text: \"一、丢失能力列表：\" }),\r\n          lostAbilities.value.length === 0\r\n              ? new Paragraph({ text: \"无\" })\r\n              : new Paragraph({\r\n                children: lostAbilities.value.map((value) =>\r\n                    new TextRun(`- 能力${value}：${allAbilities[value].label} `)\r\n                ),\r\n              }),\r\n          // 影响程度\r\n          new Paragraph({\r\n            text: `二、总体影响程度：`,\r\n          }),\r\n          new Paragraph({\r\n            text: `${impactLevel.value}`,\r\n          }),\r\n          // 影响对比表格\r\n          new Paragraph({ text: \"三、各项目影响对比：\" }),\r\n          createImpactTable(),\r\n        ],\r\n      },\r\n    ],\r\n  })\r\n\r\n  // 2. 生成 Blob 并触发下载\r\n  const blob = await Packer.toBlob(doc)\r\n  saveAs(blob, \"删除影响评估报告.docx\")\r\n}\r\n\r\n// 构建 ECharts 表格对应的 Word 表格\r\nfunction createImpactTable() {\r\n  // 表头行\r\n  const header = new TableRow({\r\n    children: [\"项目\", \"原冗余度\", \"新冗余度\", \"Δ冗余度\"]\r\n        .map(colText => new TableCell({\r\n          children: [\r\n            new Paragraph({ text: colText })\r\n          ]\r\n        }))\r\n  })\r\n\r\n  // 数据行\r\n  const rows = impactData.value.map(item => new TableRow({\r\n    children: [\r\n      new TableCell({ children: [ new Paragraph({ text: item.name }) ] }),\r\n      new TableCell({ children: [ new Paragraph({ text: (item.oldRedundancy * 100).toFixed(2) + '%'}) ] }),\r\n      new TableCell({ children: [ new Paragraph({ text: (item.newRedundancy * 100).toFixed(2) + '%'}) ] }),\r\n      new TableCell({ children: [ new Paragraph({ text: ((item.newRedundancy - item.oldRedundancy) * 100).toFixed(2) + '%'}) ] }),\r\n    ]\r\n  }))\r\n\r\n  return new Table({\r\n    rows: [ header, ...rows ],\r\n    width: { size: 100, type: \"pct\" },\r\n  })\r\n}\r\n\r\n\r\n\r\nwindow.addEventListener('error', e => {\r\n  if (e.message && e.message.includes('ResizeObserver loop')) {\r\n    e.stopImmediatePropagation()\r\n  }\r\n})\r\n\r\n\r\nconst projects = ref([\r\n  {\r\n    \"name\": \"坦克分队作战条令子项目\",\r\n    \"abilities\": [\r\n      1,\r\n      2,\r\n      3,\r\n      4,\r\n      5,\r\n      6\r\n    ],\r\n    \"satisfaction\": 0,\r\n    \"redundancy\": 0\r\n  },\r\n  {\r\n    \"name\": \"装甲步兵分队作战条令子项目\",\r\n    \"abilities\": [\r\n      1,\r\n      2,\r\n      3,\r\n      4,\r\n      5,\r\n      6\r\n    ],\r\n    \"satisfaction\": 0,\r\n    \"redundancy\": 0\r\n  },\r\n  {\r\n    \"name\": \"侦察分队作战条令子项目\",\r\n    \"abilities\": [\r\n      1,\r\n      2,\r\n      3,\r\n      4,\r\n      5,\r\n      6,\r\n      11,\r\n      12,\r\n      13,\r\n      14,\r\n      15,\r\n      17,\r\n      18,\r\n      19,\r\n      20,\r\n      21,\r\n      22,\r\n      23,\r\n      24,\r\n      25,\r\n      26,\r\n      27\r\n    ],\r\n    \"satisfaction\": 0,\r\n    \"redundancy\": 0\r\n  },\r\n  {\r\n    \"name\": \"坦克装备列装配备子项目\",\r\n    \"abilities\": [\r\n      2,\r\n      3,\r\n      4,\r\n      5,\r\n      6\r\n    ],\r\n    \"satisfaction\": 0,\r\n    \"redundancy\": 0\r\n  },\r\n  {\r\n    \"name\": \"步战车装备加改装子项目\",\r\n    \"abilities\": [\r\n      2,\r\n      3,\r\n      4,\r\n      5,\r\n      6\r\n    ],\r\n    \"satisfaction\": 0,\r\n    \"redundancy\": 0\r\n  },\r\n  {\r\n    \"name\": \"122榴弹炮装备子项目\",\r\n    \"abilities\": [\r\n      2,\r\n      3,\r\n      4,\r\n      5,\r\n      6\r\n    ],\r\n    \"satisfaction\": 0,\r\n    \"redundancy\": 0\r\n  },\r\n  {\r\n    \"name\": \"合成分队训练场子项目\",\r\n    \"abilities\": [\r\n      2,\r\n      3,\r\n      4,\r\n      5,\r\n      6,\r\n      73\r\n    ],\r\n    \"satisfaction\": 0,\r\n    \"redundancy\": 0\r\n  },\r\n  {\r\n    \"name\": \"兵种分队训练场子项目\",\r\n    \"abilities\": [\r\n      7,\r\n      8,\r\n      9,\r\n      10,\r\n      11,\r\n      12,\r\n      13,\r\n      14,\r\n      15,\r\n      16,\r\n      17,\r\n      18,\r\n      19,\r\n      20,\r\n      21,\r\n      22,\r\n      23,\r\n      24,\r\n      25,\r\n      26,\r\n      27,\r\n      28,\r\n      29,\r\n      30,\r\n      31,\r\n      32,\r\n      33,\r\n      34,\r\n      35,\r\n      36,\r\n      37,\r\n      38,\r\n      39,\r\n      40,\r\n      41,\r\n      42,\r\n      43,\r\n      44,\r\n      45,\r\n      46,\r\n      47,\r\n      48,\r\n      49,\r\n      50,\r\n      51,\r\n      52,\r\n      53,\r\n      56,\r\n      57,\r\n      58,\r\n      59,\r\n      60,\r\n      61,\r\n      62,\r\n      63,\r\n      64,\r\n      65,\r\n      66,\r\n      67,\r\n      69,\r\n      70,\r\n      71,\r\n      72,\r\n      73\r\n    ],\r\n    \"satisfaction\": 0,\r\n    \"redundancy\": 0\r\n  },\r\n  {\r\n    \"name\": \"模拟训练子项目\",\r\n    \"abilities\": [\r\n      2,\r\n      3,\r\n      4,\r\n      5,\r\n      6,\r\n      7,\r\n      8,\r\n      9,\r\n      10,\r\n      11,\r\n      12,\r\n      13,\r\n      14,\r\n      15,\r\n      16,\r\n      17,\r\n      18,\r\n      19,\r\n      20,\r\n      21,\r\n      22,\r\n      23,\r\n      24,\r\n      25,\r\n      26,\r\n      27,\r\n      28,\r\n      29,\r\n      30,\r\n      31,\r\n      32,\r\n      33,\r\n      34,\r\n      35,\r\n      36,\r\n      37,\r\n      38,\r\n      39,\r\n      40,\r\n      41,\r\n      42,\r\n      43,\r\n      44,\r\n      45,\r\n      46,\r\n      47,\r\n      48,\r\n      49,\r\n      50,\r\n      51,\r\n      52,\r\n      53,\r\n      56,\r\n      57,\r\n      58,\r\n      59,\r\n      60,\r\n      61,\r\n      62,\r\n      63,\r\n      64,\r\n      65,\r\n      66,\r\n      67,\r\n      69,\r\n      70,\r\n      71,\r\n      72,\r\n      73\r\n    ],\r\n    \"satisfaction\": 0,\r\n    \"redundancy\": 0\r\n  },\r\n  {\r\n    \"name\": \"训练与考核大纲子项目\",\r\n    \"abilities\": [\r\n      1,\r\n      2,\r\n      3,\r\n      4,\r\n      5,\r\n      6,\r\n      7,\r\n      8,\r\n      9,\r\n      10,\r\n      11,\r\n      12,\r\n      13,\r\n      14,\r\n      15,\r\n      16,\r\n      17,\r\n      18,\r\n      19,\r\n      20,\r\n      21,\r\n      22,\r\n      23,\r\n      24,\r\n      25,\r\n      26,\r\n      27,\r\n      28,\r\n      29,\r\n      30,\r\n      31,\r\n      32,\r\n      33,\r\n      34,\r\n      35,\r\n      36,\r\n      37,\r\n      38,\r\n      39,\r\n      40,\r\n      41,\r\n      42,\r\n      43,\r\n      44,\r\n      45,\r\n      46,\r\n      47,\r\n      48,\r\n      49,\r\n      50,\r\n      51,\r\n      52,\r\n      53,\r\n      56,\r\n      57,\r\n      58,\r\n      59,\r\n      60,\r\n      61,\r\n      62,\r\n      63,\r\n      64,\r\n      65,\r\n      66,\r\n      67\r\n    ],\r\n    \"satisfaction\": 0,\r\n    \"redundancy\": 0\r\n  },\r\n  {\r\n    \"name\": \"通信基础设施子项目\",\r\n    \"abilities\": [\r\n      69,\r\n      70,\r\n      71,\r\n      72,\r\n      73,\r\n      78,\r\n      80,\r\n      81,\r\n      82,\r\n      83,\r\n      84\r\n    ],\r\n    \"satisfaction\": 0,\r\n    \"redundancy\": 0\r\n  },\r\n  {\r\n    \"name\": \"维修基础设施子项目\",\r\n    \"abilities\": [\r\n      78\r\n    ],\r\n    \"satisfaction\": 0,\r\n    \"redundancy\": 0\r\n  },\r\n  {\r\n    \"name\": \"营房基础设施子项目\",\r\n    \"abilities\": [\r\n      74,\r\n      75,\r\n      78,\r\n      80,\r\n      81,\r\n      82,\r\n      83,\r\n      84\r\n    ],\r\n    \"satisfaction\": 0,\r\n    \"redundancy\": 0\r\n  },\r\n  {\r\n    \"name\": \"坦克分队编制子项目\",\r\n    \"abilities\": [\r\n      2,\r\n      3,\r\n      4,\r\n      5\r\n    ],\r\n    \"satisfaction\": 0,\r\n    \"redundancy\": 0\r\n  },\r\n  {\r\n    \"name\": \"装甲步兵分队编制子项目\",\r\n    \"abilities\": [\r\n      2,\r\n      3,\r\n      4,\r\n      5\r\n    ],\r\n    \"satisfaction\": 0,\r\n    \"redundancy\": 0\r\n  },\r\n  {\r\n    \"name\": \"侦察分队编制子项目\",\r\n    \"abilities\": [\r\n      11,\r\n      12,\r\n      13,\r\n      14,\r\n      15,\r\n      17,\r\n      18,\r\n      19,\r\n      20,\r\n      21,\r\n      22,\r\n      23,\r\n      24,\r\n      25,\r\n      26,\r\n      27,\r\n      28\r\n    ],\r\n    \"satisfaction\": 0,\r\n    \"redundancy\": 0\r\n  }\r\n])\r\n\r\nconst dialogVisible = ref(false)\r\nconst impactDialogVisible = ref(false)\r\nlet newProject = ref({\r\n  name: '',\r\n  abilities: []\r\n})\r\nlet pendingDelete = ref(null)\r\nconst impactData = ref([])\r\nconst toDelete = ref(null)\r\nconst lostAbilities = ref([])\r\nconst impactLevel = ref('')\r\n\r\nconst allAbilities = [\r\n  {\r\n    \"label\": \"远程机动能力\",\r\n    \"value\": 1\r\n  },\r\n  {\r\n    \"label\": \"战场机动能力\",\r\n    \"value\": 2\r\n  },\r\n  {\r\n    \"label\": \"对地面固定点目标打击能力\",\r\n    \"value\": 3\r\n  },\r\n  {\r\n    \"label\": \"对地面固定面目标打击能力\",\r\n    \"value\": 4\r\n  },\r\n  {\r\n    \"label\": \"对地面移动点目标打击能力\",\r\n    \"value\": 5\r\n  },\r\n  {\r\n    \"label\": \"核生化作战能力\",\r\n    \"value\": 6\r\n  },\r\n  {\r\n    \"label\": \"对敌通信干扰能力\",\r\n    \"value\": 7\r\n  },\r\n  {\r\n    \"label\": \"对敌雷达干扰能力\",\r\n    \"value\": 8\r\n  },\r\n  {\r\n    \"label\": \"计算机网络攻击能力\",\r\n    \"value\": 9\r\n  },\r\n  {\r\n    \"label\": \"对敌定位导航干扰能力\",\r\n    \"value\": 10\r\n  },\r\n  {\r\n    \"label\": \"通信侦察能力\",\r\n    \"value\": 11\r\n  },\r\n  {\r\n    \"label\": \"雷达侦察能力\",\r\n    \"value\": 12\r\n  },\r\n  {\r\n    \"label\": \"网络空间侦察能力\",\r\n    \"value\": 13\r\n  },\r\n  {\r\n    \"label\": \"可见光侦察能力\",\r\n    \"value\": 14\r\n  },\r\n  {\r\n    \"label\": \"红外侦察能力\",\r\n    \"value\": 15\r\n  },\r\n  {\r\n    \"label\": \"工程侦察能力\",\r\n    \"value\": 16\r\n  },\r\n  {\r\n    \"label\": \"生物侦察能力\",\r\n    \"value\": 17\r\n  },\r\n  {\r\n    \"label\": \"防化侦察能力\",\r\n    \"value\": 18\r\n  },\r\n  {\r\n    \"label\": \"核辐侦察能力\",\r\n    \"value\": 19\r\n  },\r\n  {\r\n    \"label\": \"目标识别能力\",\r\n    \"value\": 20\r\n  },\r\n  {\r\n    \"label\": \"数据处理能力\",\r\n    \"value\": 21\r\n  },\r\n  {\r\n    \"label\": \"情报产品生成能力\",\r\n    \"value\": 22\r\n  },\r\n  {\r\n    \"label\": \"战场情报数据共享能力\",\r\n    \"value\": 23\r\n  },\r\n  {\r\n    \"label\": \"侦察规划能力\",\r\n    \"value\": 24\r\n  },\r\n  {\r\n    \"label\": \"情报信息汇总能力\",\r\n    \"value\": 25\r\n  },\r\n  {\r\n    \"label\": \"情报信息组织能力\",\r\n    \"value\": 26\r\n  },\r\n  {\r\n    \"label\": \"情报信息分发能力\",\r\n    \"value\": 27\r\n  },\r\n  {\r\n    \"label\": \"情报信息理解能力\",\r\n    \"value\": 28\r\n  },\r\n  {\r\n    \"label\": \"态势分析能力\",\r\n    \"value\": 29\r\n  },\r\n  {\r\n    \"label\": \"作战规划能力\",\r\n    \"value\": 30\r\n  },\r\n  {\r\n    \"label\": \"决策能力\",\r\n    \"value\": 31\r\n  },\r\n  {\r\n    \"label\": \"计划制定能力\",\r\n    \"value\": 32\r\n  },\r\n  {\r\n    \"label\": \"行动协调能力\",\r\n    \"value\": 33\r\n  },\r\n  {\r\n    \"label\": \"战场监控能力\",\r\n    \"value\": 34\r\n  },\r\n  {\r\n    \"label\": \"作战数据保障能力\",\r\n    \"value\": 35\r\n  },\r\n  {\r\n    \"label\": \"超短波通信能力\",\r\n    \"value\": 36\r\n  },\r\n  {\r\n    \"label\": \"卫星通信能力\",\r\n    \"value\": 37\r\n  },\r\n  {\r\n    \"label\": \"微波通信能力\",\r\n    \"value\": 38\r\n  },\r\n  {\r\n    \"label\": \"有线通信能力\",\r\n    \"value\": 39\r\n  },\r\n  {\r\n    \"label\": \"信息共享能力\",\r\n    \"value\": 40\r\n  },\r\n  {\r\n    \"label\": \"分布式计算能力\",\r\n    \"value\": 41\r\n  },\r\n  {\r\n    \"label\": \"用户接入能力\",\r\n    \"value\": 42\r\n  },\r\n  {\r\n    \"label\": \"定位导航能力\",\r\n    \"value\": 43\r\n  },\r\n  {\r\n    \"label\": \"授时能力\",\r\n    \"value\": 44\r\n  },\r\n  {\r\n    \"label\": \"网络管理能力\",\r\n    \"value\": 45\r\n  },\r\n  {\r\n    \"label\": \"频谱管理能力\",\r\n    \"value\": 46\r\n  },\r\n  {\r\n    \"label\": \"抗干扰能力\",\r\n    \"value\": 47\r\n  },\r\n  {\r\n    \"label\": \"信息安全能力\",\r\n    \"value\": 48\r\n  },\r\n  {\r\n    \"label\": \"防空中火力打击能力\",\r\n    \"value\": 49\r\n  },\r\n  {\r\n    \"label\": \"防地面火力打击能力\",\r\n    \"value\": 50\r\n  },\r\n  {\r\n    \"label\": \"防核生化能力\",\r\n    \"value\": 51\r\n  },\r\n  {\r\n    \"label\": \"防电磁脉冲破坏能力\",\r\n    \"value\": 52\r\n  },\r\n  {\r\n    \"label\": \"防定向能武器能力\",\r\n    \"value\": 53\r\n  },\r\n  {\r\n    \"label\": \"战场军需保障能力\",\r\n    \"value\": 54\r\n  },\r\n  {\r\n    \"label\": \"战场器材保障能力\",\r\n    \"value\": 55\r\n  },\r\n  {\r\n    \"label\": \"战场油料保障能力\",\r\n    \"value\": 56\r\n  },\r\n  {\r\n    \"label\": \"战场卫生救护能力\",\r\n    \"value\": 57\r\n  },\r\n  {\r\n    \"label\": \"战场弹药保障能力\",\r\n    \"value\": 58\r\n  },\r\n  {\r\n    \"label\": \"装备战场抢救抢修能力\",\r\n    \"value\": 59\r\n  },\r\n  {\r\n    \"label\": \"装备战场维修能力\",\r\n    \"value\": 60\r\n  },\r\n  {\r\n    \"label\": \"战场保障管理能力\",\r\n    \"value\": 61\r\n  },\r\n  {\r\n    \"label\": \"道路保障能力\",\r\n    \"value\": 62\r\n  },\r\n  {\r\n    \"label\": \"工程防护能力\",\r\n    \"value\": 63\r\n  },\r\n  {\r\n    \"label\": \"地雷爆破能力\",\r\n    \"value\": 64\r\n  },\r\n  {\r\n    \"label\": \"工程破障能力\",\r\n    \"value\": 65\r\n  },\r\n  {\r\n    \"label\": \"工程伪装能力\",\r\n    \"value\": 66\r\n  },\r\n  {\r\n    \"label\": \"核生化洗消能力\",\r\n    \"value\": 67\r\n  },\r\n  {\r\n    \"label\": \"训练管理能力\",\r\n    \"value\": 68\r\n  },\r\n  {\r\n    \"label\": \"模拟训练能力\",\r\n    \"value\": 69\r\n  },\r\n  {\r\n    \"label\": \"网络训练能力\",\r\n    \"value\": 70\r\n  },\r\n  {\r\n    \"label\": \"专业技术训练能力\",\r\n    \"value\": 71\r\n  },\r\n  {\r\n    \"label\": \"专业技术协同训练能力\",\r\n    \"value\": 72\r\n  },\r\n  {\r\n    \"label\": \"分队战术训练能力\",\r\n    \"value\": 73\r\n  },\r\n  {\r\n    \"label\": \"政治教育能力\",\r\n    \"value\": 74\r\n  },\r\n  {\r\n    \"label\": \"学习娱乐能力\",\r\n    \"value\": 75\r\n  },\r\n  {\r\n    \"label\": \"营区管理能力\",\r\n    \"value\": 76\r\n  },\r\n  {\r\n    \"label\": \"装备维修保养能力\",\r\n    \"value\": 77\r\n  },\r\n  {\r\n    \"label\": \"装备管理能力\",\r\n    \"value\": 78\r\n  },\r\n  {\r\n    \"label\": \"器材管理能力\",\r\n    \"value\": 79\r\n  },\r\n  {\r\n    \"label\": \"弹药管理能力\",\r\n    \"value\": 80\r\n  },\r\n  {\r\n    \"label\": \"卫生服务能力\",\r\n    \"value\": 81\r\n  },\r\n  {\r\n    \"label\": \"油料保障能力\",\r\n    \"value\": 82\r\n  },\r\n  {\r\n    \"label\": \"给养服务能力\",\r\n    \"value\": 83\r\n  },\r\n  {\r\n    \"label\": \"生活服务能力\",\r\n    \"value\": 84\r\n  }\r\n]\r\n// let newProjectAbilities = ref([]) // 数字组成的数组，例如 [1, 3, 5]\r\n\r\n\r\nfunction calculateAll() {\r\n  const allAbilities = projects.value.flatMap(p => p.abilities)\r\n\r\n  projects.value.forEach(project => {\r\n    const total = project.abilities.length\r\n    const overlap = project.abilities.filter(a =>\r\n        allAbilities.filter(b => b === a).length > 1\r\n    ).length\r\n\r\n    project.satisfaction = total / 84\r\n    project.redundancy = total === 0 ? 0 : overlap / total\r\n  })\r\n}\r\n\r\nfunction addProject() {\r\n  if (newProject.value.name === '') {\r\n    ElMessage.warning('请填写项目名称')\r\n    return\r\n  }\r\n  if (newProject.value.abilities.length === 0) {\r\n    ElMessage.warning('请选择至少一项能力')\r\n    return\r\n  }\r\n\r\n\r\n  projects.value.push({\r\n    name: newProject.value.name,\r\n    abilities: [...newProject.value.abilities],\r\n    satisfaction: 0,\r\n    redundancy: 0\r\n  })\r\n  dialogVisible.value = false\r\n  newProject.value = { name: '', abilities: [] }\r\n  calculateAll()\r\n  ElMessage.success('项目添加成功')\r\n}\r\n\r\nfunction deleteProject(project) {\r\n  projects.value = projects.value.filter(p => p !== project)\r\n  calculateAll()\r\n  ElMessage.success('项目删除成功')\r\n}\r\n\r\n// 重写 calculateMetrics，使其能接收任意列表\r\nfunction calculateMetrics(list) {\r\n  const allAbilities = list.flatMap(p => p.abilities || [])\r\n\r\n  return list.map(p => {\r\n    const total = (p.abilities || []).length\r\n    const overlap = (p.abilities || []).filter(a =>\r\n        allAbilities.filter(b => b === a).length > 1\r\n    ).length\r\n\r\n    return {\r\n      name: p.name,\r\n      satisfaction: total / 84,\r\n      redundancy: total > 0 ? overlap / total : 0\r\n    }\r\n  })\r\n}\r\n\r\n\r\nfunction prepareDelete(row) {\r\n  // 能力影响\r\n  toDelete.value = row\r\n  const abilityCount = {}\r\n  projects.value.forEach(p => {\r\n    if (p === row) return\r\n    p.abilities.forEach(a => {\r\n      abilityCount[a] = (abilityCount[a] || 0) + 1\r\n    })\r\n  })\r\n  lostAbilities.value = row.abilities.filter(a => !abilityCount[a])\r\n  const lost = lostAbilities.value.length\r\n  if (lost === 0) impactLevel.value = '小'\r\n  else if (lost <= 2) impactLevel.value = '中'\r\n  else impactLevel.value = '大'\r\n  impactDialogVisible.value = true\r\n\r\n  pendingDelete.value = row\r\n  // 计算删除后项目影响\r\n  const before = projects.value.map(p => ({ name: p.name, abilities: p.abilities.slice() }))\r\n  const afterList = projects.value.filter(p => p !== row)\r\n  const allAblts = afterList.flatMap(p => p.abilities)\r\n  afterList.forEach(project => {\r\n    const total = project.abilities.length\r\n    const overlap = project.abilities.filter(a =>\r\n        allAblts.filter(b => b === a).length > 1\r\n    ).length\r\n    project.redundancy = total === 0 ? 0 : overlap / total\r\n  })\r\n  impactData.value = afterList.map(p => ({\r\n    name: p.name,\r\n    oldRedundancy: before.find(x=>x.name===p.name).abilities.filter(a=>{\r\n      const allBefore=before.flatMap(x=>x.abilities)\r\n      return allBefore.filter(y=>y===a).length>1\r\n    }).length / p.abilities.length,\r\n    newRedundancy: p.redundancy\r\n  }))\r\n  impactDialogVisible.value = true\r\n}\r\n\r\n\r\n// 最终在确认删除按钮中调用：\r\nfunction confirmDelete() {\r\n  projects.value = projects.value.filter(p => p !== pendingDelete.value)\r\n  // 重新计算主表指标\r\n  calculateAll()\r\n  pendingDelete.value = null\r\n  impactDialogVisible.value = false\r\n  ElMessage.success('项目已删除')\r\n}\r\n\r\ncalculateAll()\r\n</script>","import script from \"./CapabilityTable.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./CapabilityTable.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./CapabilityTable.vue?vue&type=style&index=0&id=54afd7bf&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-54afd7bf\"]])\n\nexport default __exports__","<template>\r\n  <div>\r\n    <h2 class=\"text-xl font-bold mb-4\">项目能力分类决策树</h2>\r\n\r\n    <!-- 表格输入区域 -->\r\n    <el-table :data=\"tableData\" border style=\"width: 100%; margin-bottom: 16px;\">\r\n      <el-table-column prop=\"project\" label=\"项目\" fixed width=\"160\" />\r\n      <el-table-column\r\n          v-for=\"(ability, index) in abilities\"\r\n          :key=\"index\"\r\n          :label=\"ability\"\r\n          :prop=\"ability\"\r\n          width=\"110\"\r\n      >\r\n        <template #default=\"{ row }\">\r\n          <el-input-number\r\n              style=\"width: 80px;\"\r\n              v-model=\"row.values[index]\"\r\n              size=\"small\"\r\n              :step=\"0.01\"\r\n              :precision=\"2\"\r\n              controls-position=\"right\"\r\n              @change=\"val => {\r\n    if (val < 0 || val > 1) {\r\n      ElMessage.warning('请输入 0~1 之间的得分')\r\n      row.values[index] = Math.min(1, Math.max(0, val))\r\n    }\r\n  }\"\r\n          />\r\n\r\n\r\n          <!--          <el-input-->\r\n<!--              v-model.number=\"row.values[index]\"-->\r\n<!--              size=\"small\"-->\r\n<!--              :min=\"0\"-->\r\n<!--              :max=\"1\"-->\r\n<!--              type=\"number\"-->\r\n<!--          />-->\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n\r\n    <el-button type=\"primary\" @click=\"generateTree\">生成决策树</el-button>\r\n\r\n    <!-- 图表展示 -->\r\n    <div ref=\"chart\" class=\"chart-container\"></div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, onMounted, onBeforeUnmount } from 'vue'\r\nimport * as echarts from 'echarts'\r\nimport { ElInput, ElButton, ElTable, ElTableColumn, ElMessage } from 'element-plus'\r\n\r\n// 能力名称（13个）\r\nconst abilities = [\r\n  '机动能力', '火力打击能力', '网电对抗能力', '战场感知能力', '情报处理能力',\r\n  '作战指挥能力', '网信保障能力', '综合防护能力', '后勤保障能力', '装备保障能力',\r\n  '作战保障能力', '训练能力', '平时保障能力'\r\n]\r\n\r\n// 项目名称（16个）\r\nconst projectNames = [\r\n  '坦克分队作战条令子项目', '装甲步兵分队作战条令子项目', '侦察分队作战条令子项目',\r\n  '坦克装备列装配备子项目', '步战车装备加改装子项目', '122榴弹炮装备子项目',\r\n  '合成分队训练场子项目', '兵种分队训练场子项目', '模拟训练子项目', '训练与考核大纲子项目',\r\n  '通信基础设施子项目', '维修基础设施子项目', '营房基础设施子项目',\r\n  '坦克分队编制子项目', '装甲步兵分队编制子项目', '侦察分队编制子项目'\r\n]\r\n\r\n// 初始化表格数据\r\nconst tableData = reactive(\r\n    projectNames.map(name => ({\r\n      project: name,\r\n      values: Array.from({ length: abilities.length }, () =>\r\n          parseFloat((Math.random() * 0.8 + 0.1).toFixed(2))\r\n      )\r\n    }))\r\n)\r\n\r\n// chart 引用和渲染实例\r\nconst chart = ref(null)\r\nlet myChart = null\r\n\r\nonMounted(() => {\r\n  myChart = echarts.init(chart.value)\r\n  window.addEventListener('resize', () => myChart?.resize())\r\n})\r\n\r\nonBeforeUnmount(() => {\r\n  window.removeEventListener('resize', () => myChart?.resize())\r\n  myChart?.dispose()\r\n})\r\n\r\n// 核心函数：递归生成决策树数据\r\nfunction buildDecisionTree(data, depth = 0, maxDepth = 10) {\r\n  if (data.length === 1 || depth >= maxDepth) {\r\n    return { name: data[0].project }\r\n  }\r\n\r\n  const bestFeature = getBestSplitFeature(data)\r\n  if (bestFeature === -1) return { name: data[0].project }\r\n\r\n  const threshold = 0.5\r\n  const left = data.filter(d => d.values[bestFeature] <= threshold)\r\n  const right = data.filter(d => d.values[bestFeature] > threshold)\r\n\r\n  if (left.length === 0 || right.length === 0) {\r\n    return { name: data[0].project }\r\n  }\r\n\r\n  return {\r\n    name: `${abilities[bestFeature]} > ${threshold}?`,\r\n    children: [\r\n      buildDecisionTree(right, depth + 1, maxDepth),\r\n      buildDecisionTree(left, depth + 1, maxDepth)\r\n    ]\r\n  }\r\n}\r\n\r\n// 简单的方差分裂选择最佳划分特征\r\nfunction getBestSplitFeature(data) {\r\n  let bestIndex = -1\r\n  let bestScore = -Infinity\r\n\r\n  for (let i = 0; i < abilities.length; i++) {\r\n    const left = [], right = []\r\n    for (const row of data) {\r\n      if (row.values[i] <= 0.5) left.push(row)\r\n      else right.push(row)\r\n    }\r\n    const score = left.length * left.length + right.length * right.length\r\n    if (score > bestScore && left.length > 0 && right.length > 0) {\r\n      bestScore = score\r\n      bestIndex = i\r\n    }\r\n  }\r\n  return bestIndex\r\n}\r\n\r\n// 点击生成按钮时生成图表\r\nfunction generateTree() {\r\n  const valid = tableData.every(d => typeof d.project === 'string' && d.project && d.values.some(v => v > 0))\r\n  if (!valid) {\r\n    ElMessage.error('请确保每个项目填写完整并且包含至少一个非零能力值')\r\n    return\r\n  }\r\n\r\n  const tree = buildDecisionTree(tableData)\r\n\r\n  const option = {\r\n    tooltip: {\r\n      trigger: 'item',\r\n      triggerOn: 'mousemove'\r\n    },\r\n    series: [\r\n      {\r\n        type: 'tree',\r\n        data: [tree],\r\n        top: '5%',\r\n        left: '15%',\r\n        bottom: '5%',\r\n        right: '15%',\r\n        symbol: 'emptyCircle',\r\n        orient: 'horizontal',\r\n        expandAndCollapse: true,\r\n        initialTreeDepth: 10,\r\n        label: {\r\n          position: 'left',\r\n          verticalAlign: 'middle',\r\n          align: 'right',\r\n          fontSize: 14\r\n        },\r\n        leaves: {\r\n          label: {\r\n            position: 'right',\r\n            verticalAlign: 'middle',\r\n            align: 'left'\r\n          }\r\n        },\r\n        animationDurationUpdate: 750\r\n      }\r\n    ]\r\n  }\r\n\r\n  myChart.setOption(option)\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.chart-container {\r\n  width: 100%;\r\n  height: 600px;\r\n  margin-top: 20px;\r\n  background: #fafafa;\r\n  border: 1px solid #e0e0e0;\r\n  border-radius: 4px;\r\n  padding: 8px;\r\n}\r\n</style>\r\n\r\n","import script from \"./DecisionTree.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./DecisionTree.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./DecisionTree.vue?vue&type=style&index=0&id=08db8bdc&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-08db8bdc\"]])\n\nexport default __exports__","// import { createRouter, createWebHistory } from 'vue-router'\r\nimport GanttChart from '../views/GanttChart.vue'\r\nimport CapabilityTable from '../views/CapabilityTable.vue'\r\nimport DecisionTree from '../views/DecisionTree.vue'\r\n\r\nimport { createRouter, createWebHashHistory } from 'vue-router'\r\n\r\n\r\nconst routes = [\r\n    { path: '/', redirect: '/gantt' },\r\n    { path: '/gantt', component: GanttChart },\r\n    { path: '/capability', component: CapabilityTable },\r\n    { path: '/decision', component: DecisionTree }\r\n]\r\n\r\n// const router = createRouter({\r\n//     history: createWebHistory(),\r\n//     routes\r\n// })\r\n\r\n\r\nconst router = createRouter({\r\n    history: createWebHashHistory(),\r\n    routes: routes\r\n})\r\n\r\n// const router = new VueRouter({\r\n//     mode: 'hash',\r\n//     routes: routes\r\n// })\r\n\r\n\r\nexport default router","import { createApp } from 'vue'\r\nimport App from './App.vue'\r\nimport router from './router'\r\nimport ElementPlus from 'element-plus'\r\nimport 'element-plus/dist/index.css'\r\n\r\n\r\nconst app = createApp(App)\r\n\r\napp.use(router).use(ElementPlus).mount('#app')\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t524: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = function(chunkId) { return installedChunks[chunkId] === 0; };\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = function(parentChunkLoadingFunction, data) {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some(function(id) { return installedChunks[id] !== 0; })) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkghjhxm\"] = self[\"webpackChunkghjhxm\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [504], function() { return __webpack_require__(1096); })\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["id","class","mode","activeTab","router","index","setup","route","path","__exports__","render","treeData","currentView","ganttContainer","chart","myChart","tasksData","data","text","start_date","duration","parent","unit","links","source","target","type","setAllView","config","scale_unit","date_scale","subscales","step","date","resizeChart","resize","afterDragEventId","xml_date","cascade_delete","show_tasks_outside_timescale","drag_progress","columns","name","label","width","tree","align","lightbox","sections","height","map_to","focus","locale","month_full","month_short","day_full","day_short","hours","minutes","seconds","date_format","time_format","month_day","Object","assign","labels","new_task","icon_save","icon_cancel","icon_details","icon_edit","icon_delete","confirm_closing","confirm_deleting","section_description","section_time","save_button","cancel_button","delete_button","Date","end_date","templates","task_class","s","e","task","classes","root","pid","p","getTask","push","join","attachEvent","children","getChildren","length","invalidChild","find","cid","c","alert","forEach","link","parseDate","sourceEnd","calculateEndDate","targetEnd","init","value","parse","setTimeout","eachTask","t","hasChild","open","echarts","option","tooltip","trigger","triggerOn","series","roam","top","left","bottom","right","symbol","orient","expandAndCollapse","initialTreeDepth","position","verticalAlign","fontSize","padding","leaves","formatter","params","split","overflow","grid","setOption","window","addEventListener","detachEvent","clearAll","removeEventListener","dispose","async","exportReport","doc","creator","title","description","styles","paragraphStyles","run","font","size","properties","heading","lostAbilities","map","allAbilities","impactLevel","createImpactTable","blob","toBlob","saveAs","header","colText","rows","impactData","item","oldRedundancy","toFixed","newRedundancy","message","includes","stopImmediatePropagation","projects","dialogVisible","impactDialogVisible","newProject","abilities","pendingDelete","toDelete","calculateAll","flatMap","project","total","overlap","filter","a","b","satisfaction","redundancy","addProject","success","warning","prepareDelete","row","abilityCount","lost","before","slice","afterList","allAblts","x","allBefore","y","confirmDelete","projectNames","tableData","values","Array","from","parseFloat","Math","random","buildDecisionTree","depth","maxDepth","bestFeature","getBestSplitFeature","threshold","d","bestIndex","bestScore","Infinity","i","score","generateTree","valid","every","some","v","error","animationDurationUpdate","routes","redirect","component","GanttChart","CapabilityTable","DecisionTree","history","app","App","use","mount","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","call","m","deferred","O","result","chunkIds","fn","priority","notFulfilled","fulfilled","j","keys","key","splice","r","definition","o","defineProperty","enumerable","get","g","globalThis","this","Function","obj","prop","prototype","hasOwnProperty","Symbol","toStringTag","installedChunks","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","chunkLoadingGlobal","self","bind","__webpack_exports__"],"sourceRoot":""}